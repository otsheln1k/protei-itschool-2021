# shmem

Программа `send` передаёт программе `recv` сообщения через общую память.

Использование:

```
send NAME [BUFSIZE]
recv NAME
```

`NAME` это идентификатор, который используется для создания имени области общей памяти (на самом деле будет `/shmem-NAME`), `BUFSIZE` это размер буфера для сообщения (размер всей области общей памяти будет `BUFSIZE + 2*sizeof(sem_t)`).

Синхронизация через 2 семафора POSIX: у одного значение 1 когда доступно чтение, а у другого когда доступна запись в буфер. Каждая сторона дожидается готовности другой через `sem_wait`. Семафоры распологаюстя в начале области общей памяти.

Обе программы обрабатывают `SIGINT`, `send` также обрабатывает конец файла: во всех этих случаях соединение обрывается. Обрыв соединения обозначается через значение 1 на обоих семафорах (`send` может его увидеть только при попытке записи очередного сообщения). Программа, увидевшая обрыв соединения, должна уничтожить оба семафора. Ссылка на область общей памяти всегда удаляется из файловой системы программой `recv`.
